{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "MicrosoftSentinelAutomationRuleSpec",
  "type": "object",
  "required": [
    "properties"
  ],
  "properties": {
    "properties": {
      "$ref": "#/definitions/Properties"
    }
  },
  "definitions": {
    "Action": {
      "oneOf": [
        {
          "type": "object",
          "required": [
            "AddIncidentTagAction"
          ],
          "properties": {
            "AddIncidentTagAction": {
              "$ref": "#/definitions/AddIncidentTagAction"
            }
          },
          "additionalProperties": false
        },
        {
          "type": "object",
          "required": [
            "RunPlaybookAction"
          ],
          "properties": {
            "RunPlaybookAction": {
              "$ref": "#/definitions/RunPlaybookAction"
            }
          },
          "additionalProperties": false
        }
      ]
    },
    "AddIncidentTagAction": {
      "type": "object",
      "required": [
        "actionConfiguration",
        "actionType",
        "order"
      ],
      "properties": {
        "actionConfiguration": {
          "$ref": "#/definitions/AddIncidentTaskActionProperties"
        },
        "actionType": {
          "$ref": "#/definitions/AddIncidentTaskActionType"
        },
        "order": {
          "type": "integer",
          "format": "int64"
        }
      }
    },
    "AddIncidentTaskActionProperties": {
      "type": "object",
      "required": [
        "description",
        "title"
      ],
      "properties": {
        "description": {
          "type": "string"
        },
        "title": {
          "type": "string"
        }
      }
    },
    "AddIncidentTaskActionType": {
      "type": "string",
      "enum": [
        "Add Incident Task"
      ]
    },
    "BooleanCondition": {
      "type": "object",
      "required": [
        "innerConditions",
        "operator"
      ],
      "properties": {
        "innerConditions": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/Condition"
          }
        },
        "operator": {
          "$ref": "#/definitions/BooleanConditionSupportedOperator"
        }
      }
    },
    "BooleanConditionSupportedOperator": {
      "type": "string",
      "enum": [
        "And",
        "Or"
      ]
    },
    "Condition": {
      "oneOf": [
        {
          "type": "object",
          "required": [
            "conditionProperties",
            "conditionType"
          ],
          "properties": {
            "conditionProperties": {
              "$ref": "#/definitions/BooleanCondition"
            },
            "conditionType": {
              "type": "string",
              "enum": [
                "Boolean"
              ]
            }
          }
        },
        {
          "type": "object",
          "required": [
            "conditionProperties",
            "conditionType"
          ],
          "properties": {
            "conditionProperties": {
              "$ref": "#/definitions/PropertyArrayChangedValuesCondition"
            },
            "conditionType": {
              "type": "string",
              "enum": [
                "Property Array Changed"
              ]
            }
          }
        }
      ]
    },
    "PlaybookActionProperties": {
      "type": "object",
      "required": [
        "logicAppResourceId",
        "tenantId"
      ],
      "properties": {
        "logicAppResourceId": {
          "type": "string"
        },
        "tenantId": {
          "type": "string"
        }
      }
    },
    "Properties": {
      "type": "object",
      "required": [
        "actions",
        "displayName",
        "order",
        "triggeringLogic"
      ],
      "properties": {
        "actions": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/Action"
          }
        },
        "displayName": {
          "type": "string"
        },
        "order": {
          "type": "integer",
          "format": "int64"
        },
        "triggeringLogic": {
          "$ref": "#/definitions/TriggeringLogic"
        }
      }
    },
    "PropertyArrayChangedConditionSupportedArrayType": {
      "type": "string",
      "enum": [
        "Alerts",
        "Comments",
        "Labels",
        "Tactics"
      ]
    },
    "PropertyArrayChangedConditionSupportedChangeType": {
      "type": "string",
      "enum": [
        "Added"
      ]
    },
    "PropertyArrayChangedValuesCondition": {
      "type": "object",
      "required": [
        "arrayType",
        "changeType"
      ],
      "properties": {
        "arrayType": {
          "$ref": "#/definitions/PropertyArrayChangedConditionSupportedArrayType"
        },
        "changeType": {
          "$ref": "#/definitions/PropertyArrayChangedConditionSupportedChangeType"
        }
      }
    },
    "RunPlaybookAction": {
      "type": "object",
      "required": [
        "actionConfiguration",
        "actionType",
        "order"
      ],
      "properties": {
        "actionConfiguration": {
          "$ref": "#/definitions/PlaybookActionProperties"
        },
        "actionType": {
          "$ref": "#/definitions/RunPlaybookActionType"
        },
        "order": {
          "type": "integer",
          "format": "int64"
        }
      }
    },
    "RunPlaybookActionType": {
      "type": "string",
      "enum": [
        "Run Playbook"
      ]
    },
    "TriggeringLogic": {
      "type": "object",
      "required": [
        "conditions",
        "expirationTimeUtc",
        "isEnabled",
        "triggersOn",
        "triggersWhen"
      ],
      "properties": {
        "conditions": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/Condition"
          }
        },
        "expirationTimeUtc": {
          "type": "string"
        },
        "isEnabled": {
          "type": "boolean"
        },
        "triggersOn": {
          "$ref": "#/definitions/TriggersOn"
        },
        "triggersWhen": {
          "$ref": "#/definitions/TriggersWhen"
        }
      }
    },
    "TriggersOn": {
      "type": "string",
      "enum": [
        "Incident",
        "Alerts"
      ]
    },
    "TriggersWhen": {
      "type": "string",
      "enum": [
        "Created",
        "Updated"
      ]
    }
  }
}